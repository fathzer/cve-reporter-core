package com.fathzer.cvereporter;

import java.util.Set;

import com.fathzer.cvereporter.cve.Version;

import lombok.AllArgsConstructor;
import lombok.EqualsAndHashCode;
import lombok.Getter;

@AllArgsConstructor
@Getter
public class Dependencies {
	public enum Status { OK, NOT_THIS_BUILDER, NOT_SUPPORTED, BUILD_ERROR, ALERT }
	
	private Status searchStatus;
	private Set<Dependency> dependencies;

	@EqualsAndHashCode
	public static class Dependency {
		@Getter
		private final ArtifactId id;
		@Getter
		private final Version version;
		private final String versionString;
		
		public Dependency(String group, String artifactd, String version) {
			this(new ArtifactId(group, artifactd), version);
		}

		public Dependency(ArtifactId id, String version) {
			this.id = id;
			this.versionString = version;
			this.version = new Version(version);
		}
		
		@Override
		public String toString() {
			return id+":"+versionString;
		}
	}
	
	@AllArgsConstructor
	@Getter
	@EqualsAndHashCode
	public static class ArtifactId {
		private final String group;
		private final String artifact;

		@Override
		public String toString() {
			return group+":"+artifact;
		}
	}
}
