package com.fathzer.cvereporter.cve;

import com.fathzer.cvereporter.Dependencies.ArtifactId;
import com.fathzer.cvereporter.common.Dependency;
import com.fathzer.cvereporter.common.VersionRange;

/** A vulnerability.
 */
public class CVE {
	private final ArtifactId id;
	private final VersionRange range;
	private final String description;

	/** Constructor.
	 * @param id An artifactId
	 * @param range A version range
	 * @param description The CVE
	 */
	public CVE(ArtifactId id, VersionRange range, String description) {
		this.id = id;
		this.description = description;
		this.range = range;
	}

	/** Tests wheter this CVE concerns a dependency. 
	 * @param dependency The dependency to test
	 * @return true if this vulnerability concerns the dependency
	 */
	public boolean concerns(Dependency dependency) {
		return id.equals(dependency.getId()) && range.contains(dependency.getVersion());
	}

	/** Gets the artifact id of this CVE.
	 * @return an artifact id
	 */
	public ArtifactId getId() {
		return id;
	}

	/** Gets the description of this CVE.
	 * @return a String
	 */
	public String getDescription() {
		return description;
	}
}
