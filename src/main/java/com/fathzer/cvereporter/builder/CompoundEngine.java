package com.fathzer.cvereporter.builder;

import java.io.IOException;
import java.util.Arrays;
import java.util.Collection;
import java.util.LinkedList;

import com.fathzer.cvereporter.Project;

public class CompoundEngine implements BuildEngine {
	private final Collection<BuildEngine> engines;

	public CompoundEngine(BuildEngine... engines) {
		this(Arrays.asList(engines));
	}

	public CompoundEngine(Collection<BuildEngine> engines) {
		this.engines = new LinkedList<>(engines);
	}
	
	public void add(BuildEngine... engine) {
		engines.addAll(Arrays.asList(engine));
	}

	@Override
	public DependencySet getDependencies(Project project) throws IOException {
		for (BuildEngine engine : engines) {
			final DependencySet result = engine.getDependencies(project);
			if (!BuildStatus.NOT_THIS_BUILDER.equals(result.getStatus())) {
				return result;
			}
		}
		return new DependencySet(BuildStatus.NOT_THIS_BUILDER, null);
	}

}
