package com.fathzer.cvereporter.common;

import static org.junit.jupiter.api.Assertions.*;

import java.io.IOException;

import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.databind.ObjectMapper;

import lombok.Getter;

class ProjectTest {

	@Test
	void test() {
		assertThrows(NullPointerException.class, () -> new Project(null, "xxx"));
		assertThrows(NullPointerException.class, () -> new Project("xxx", null));
		
		final Project p1 = new Project("1","p");
		final Project p1Bis = new Project("1","p");
		assertEquals(p1,p1Bis);
		assertEquals(p1.hashCode(),p1Bis.hashCode());
		assertNotEquals(p1, new Project("1","xxx"));
		assertNotEquals(p1, new Project("2","p"));
	}
	
	@Test
	void testSerialization() throws IOException {
		final Project p = new Project("a", "b");
		final ObjectMapper mapper = new ObjectMapper();
		final String json = mapper.writeValueAsString(p);
		assertEquals(p, mapper.readValue(json, Project.class));
		
		final Project b = new Project("a","b") {
			@Getter
			private String other = "other";
		};
		final String json2 = mapper.writeValueAsString(b);
		assertNotEquals(json, json2);
		assertEquals(p, mapper.readValue(json2, Project.class));
	}
}
