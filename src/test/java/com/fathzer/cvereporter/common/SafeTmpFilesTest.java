package com.fathzer.cvereporter.common;

import static org.junit.jupiter.api.Assertions.*;

import java.io.File;
import java.io.IOException;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;

import org.junit.jupiter.api.Test;

class SafeTmpFilesTest {
	@Test
	void test() throws IOException {
		File tmpDir = SafeTmpFiles.createTempDirectory("test");
		Files.write(new File(tmpDir, "content.text").toPath(), "content".getBytes(StandardCharsets.UTF_8));
		SafeTmpFiles.forceDelete(tmpDir);
		assertFalse(tmpDir.exists());
		
		assertThrows(IOException.class, () -> SafeTmpFiles.cleanDirectory(tmpDir));
		
		File tmpFile = SafeTmpFiles.createTempFile("prefix", ".suffix");
		assertTrue(tmpFile.getName().startsWith("prefix"));
		assertTrue(tmpFile.getName().endsWith(".suffix"));
	}
}
