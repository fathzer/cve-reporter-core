package com.fathzer.cvereporter.common;

import static org.junit.jupiter.api.Assertions.*;

import java.io.IOException;

import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.databind.ObjectMapper;

import lombok.Getter;

class ArtifactTest {

	@Test
	void test() {
		assertThrows(NullPointerException.class, () -> new Artifact(null, "toto"));
		assertThrows(NullPointerException.class, () -> new Artifact("toto", null));
		assertEquals("a:b", new Artifact("a", "b").toString());
	}

	@Test
	void testSerialization() throws IOException {
		final ObjectMapper mapper = new ObjectMapper();
		final Artifact a = new Artifact("a", "b");
		final String json = mapper.writeValueAsString(a);
		assertEquals(a, mapper.readValue(json, Artifact.class));
		
		final Artifact b = new Artifact("a", "b") {
			@Getter
			private String other = "other";
		};
		final String json2 = mapper.writeValueAsString(b);
		assertNotEquals(json, json2);
		assertEquals(a, mapper.readValue(json2, Artifact.class));
	}
}
