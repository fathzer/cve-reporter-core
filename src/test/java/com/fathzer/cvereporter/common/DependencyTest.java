package com.fathzer.cvereporter.common;

import static org.junit.jupiter.api.Assertions.*;

import java.io.IOException;

import org.junit.jupiter.api.Test;

import com.fasterxml.jackson.databind.ObjectMapper;

import lombok.Getter;

class DependencyTest {

	@Test
	void test() {
		assertEquals("a:b:1.0",new Dependency(new Artifact("a","b"), new Version("1.0"), false).toString());
		assertEquals("a:b:1.0 (test)",new Dependency(new Artifact("a","b"), new Version("1.0"), true).toString());
	}

	@Test
	void testSerialization() throws IOException {
		final Artifact a = new Artifact("a", "b");
		final Dependency d = new Dependency(a, new Version("1.0.0"), true);
		final ObjectMapper mapper = new ObjectMapper();
		final String json = mapper.writeValueAsString(d);
		assertEquals(d, mapper.readValue(json, Dependency.class));
		
		final Dependency b = new Dependency(a, new Version("1.0.0"), true) {
			@Getter
			private String other = "other";
		};
		final String json2 = mapper.writeValueAsString(b);
		assertNotEquals(json, json2);
		assertEquals(d, mapper.readValue(json2, Dependency.class));
	}

}
